<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>IllegalCreed SlideStack</title>
    <style>
      body {
        margin: 0;
        padding: 0;
        display: flex;
        justify-content: center;
        align-items: center;
        min-height: 100vh;
        font-family: Arial, sans-serif;
        background-color: #fff;
        color: #333;
      }
      .not-found {
        text-align: center;
        padding: 40px;
      }
      .not-found h1 {
        font-size: 80px;
        font-weight: bold;
        margin: 0;
        line-height: 1;
        color: #333;
      }
      .not-found h2 {
        font-size: 22px;
        font-weight: normal;
        margin: 10px 0;
        letter-spacing: 2px;
      }
      .not-found p {
        font-size: 16px;
        color: #666;
        margin: 20px 0 30px;
        max-width: 400px;
        line-height: 1.5;
      }
      .not-found a {
        display: inline-block;
        padding: 12px 24px;
        background-color: transparent;
        color: #007bff;
        border: 1px solid #007bff;
        border-radius: 50px;
        text-decoration: none;
        font-size: 14px;
        font-weight: bold;
        transition: background-color 0.3s, color 0.3s;
      }
      .not-found a:hover {
        background-color: #007bff;
        color: #fff;
      }
    </style>
  </head>
  <body>
    <script type="text/javascript">
      // Single Page Apps for GitHub Pages
      // MIT License
      // https://github.com/rafgraph/spa-github-pages
      // This script takes the current url and converts the path and query
      // string into just a query string, and then redirects the browser
      // to the new url with only a query string and hash fragment,
      // e.g. https://www.foo.tld/one/two?a=b&c=d#qwe, becomes
      // https://www.foo.tld/?/one/two&a=b~and~c=d#qwe
      // Note: this 404.html file must be at least 512 bytes for it to work
      // with Internet Explorer (it is currently > 512 bytes)

      // If you're creating a Project Pages site and NOT using a custom domain,
      // then set pathSegmentsToKeep to 1 (enterprise users may need to set it to > 1).
      // This way the code will only replace the route part of the path, and not
      // the real directory in which the app resides, for example:
      // https://username.github.io/repo-name/one/two?a=b&c=d#qwe becomes
      // https://username.github.io/repo-name/?/one/two&a=b~and~c=d#qwe
      // Otherwise, leave pathSegmentsToKeep as 0.
      // 配置项
      const config = {
        pathSegmentsToKeep: 2, // 项目页面的目录深度
        paramSeparator: "~and~", // 参数分隔符
      };

      // 获取当前URL相关信息
      const pathname = window.location.pathname;
      const search = window.location.search;
      const pathSegments = pathname.split("/").filter((segment) => segment);

      // 检查是否已经在重定向后的URL格式，避免无限循环
      if (
        search.startsWith("?/") ||
        pathSegments.length <= config.pathSegmentsToKeep
      ) {
        // 如果已经是目标格式或路径段不足，直接退出
        document.body.innerHTML = `
          <div class="not-found">
            <h1>404</h1>
            <h2>PAGE NOT FOUND</h2>
            <p>But if you don't change your direction, and if you keep looking, you may end up where you are heading.</p>
            <a href="/SlideStack/prettier-slide/">Go to Prettier Slide</a>
          </div>
        `;
      } else {
        // 分割基础路径和路由路径
        const basePath = pathSegments
          .slice(0, config.pathSegmentsToKeep)
          .join("/");
        const routePath = pathSegments
          .slice(config.pathSegmentsToKeep)
          .join("/");

        // 构建新的查询字符串
        const newSearch = [
          routePath ? `/${routePath}` : "",
          search ? search.slice(1) : "",
        ]
          .filter(Boolean)
          .join("&")
          .replace(/&/g, config.paramSeparator);

        // 重定向到新URL
        const newUrl = `${window.location.protocol}//${window.location.hostname}${
          window.location.port ? ":" + window.location.port : ""
        }/${basePath}/?${newSearch}${window.location.hash}`;

        window.location.replace(newUrl);
      }
    </script>
  </body>
</html>
